import{r as d,m as D,p as L,b as r,o,d as e,e as c,i as j,j as B,u as b,R as C,t as i,q as N,n as m,f as h,F as S,g as F,l as I}from"../app.js";const V={class:"p-6 space-y-6"},q={class:"flex items-center gap-4"},M={class:"mt-1 text-sm text-zinc-400"},R={class:"text-zinc-500"},A={key:0,class:"flex items-center gap-6 text-sm"},P={class:"text-zinc-400"},U={key:0,class:"text-zinc-400"},E={class:"text-zinc-300 bg-zinc-800 px-1.5 py-0.5 rounded"},O={class:"rounded-xl border border-zinc-800 bg-zinc-900 overflow-hidden"},T={class:"border-b border-zinc-800 px-4 py-3 flex items-center justify-between"},G={class:"flex items-center gap-3"},H={key:0,class:"text-xs text-zinc-500"},J={key:0,class:"flex items-center gap-2 text-sm text-amber-400"},K={class:"max-h-[600px] overflow-auto"},Q={key:0,class:"flex items-center justify-center py-12"},W={key:1,class:"font-mono text-xs"},X={class:"text-zinc-600 select-none w-12 flex-shrink-0 text-right pr-4"},Y={key:2,class:"px-4 py-12 text-center text-zinc-500"},ee={__name:"DeploymentDetail",setup(Z){const p=N(),f=I("api"),n=d(null),l=d([]),_=d(!0),x=d(!0);let u=null;async function g(){try{n.value=await f.getDeployment(p.params.uuid)}catch(t){console.error("Failed to fetch deployment:",t)}finally{_.value=!1}}async function v(){try{const t=await f.getDeploymentLogs(p.params.uuid);l.value=Array.isArray(t.logs)?t.logs:[]}catch(t){console.error("Failed to fetch logs:",t)}finally{x.value=!1}}function w(t){return t?new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-"}function z(t){return t==="finished"?"bg-emerald-500/10 text-emerald-400":t==="failed"?"bg-red-500/10 text-red-400":t==="in_progress"?"bg-amber-500/10 text-amber-400":"bg-zinc-500/10 text-zinc-400"}function k(t){return t?(t.output||t.toString()).replace(/\x1b\[[0-9;]*m/g,""):""}return D(async()=>{await Promise.all([g(),v()]),(n.value?.status==="in_progress"||n.value?.status==="queued")&&(u=setInterval(async()=>{await Promise.all([g(),v()]),n.value?.status!=="in_progress"&&n.value?.status!=="queued"&&clearInterval(u)},3e3))}),L(()=>{u&&clearInterval(u)}),(t,s)=>(o(),r("div",V,[e("div",q,[j(b(C),{to:"/deployments",class:"flex h-8 w-8 items-center justify-center rounded-lg border border-zinc-800 hover:bg-zinc-800 transition-colors"},{default:B(()=>[...s[0]||(s[0]=[e("svg",{class:"h-4 w-4 text-zinc-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"})],-1)])]),_:1}),e("div",null,[s[1]||(s[1]=e("h1",{class:"text-2xl font-semibold text-white"},"Deployment Logs",-1)),e("p",M,[e("code",R,i(b(p).params.uuid),1)])])]),n.value?(o(),r("div",A,[e("span",{class:m([z(n.value.status),"inline-flex items-center rounded-full px-3 py-1 text-sm font-medium capitalize"])},i(n.value.status),3),e("span",P," Started "+i(w(n.value.created_at)),1),n.value.commit?(o(),r("span",U,[s[2]||(s[2]=h(" Commit: ",-1)),e("code",E,i(n.value.commit?.substring(0,7)),1)])):c("",!0)])):c("",!0),e("div",O,[e("div",T,[e("div",G,[s[3]||(s[3]=e("span",{class:"text-sm font-medium text-white"},"Build Output",-1)),l.value.length?(o(),r("span",H,i(l.value.length)+" lines",1)):c("",!0)]),n.value?.status==="in_progress"?(o(),r("div",J,[...s[4]||(s[4]=[e("div",{class:"h-2 w-2 rounded-full bg-amber-400 animate-pulse"},null,-1),h(" Building... ",-1)])])):c("",!0)]),e("div",K,[x.value?(o(),r("div",Q,[...s[5]||(s[5]=[e("div",{class:"h-6 w-6 animate-spin rounded-full border-2 border-zinc-700 border-t-violet-500"},null,-1)])])):l.value.length?(o(),r("div",W,[(o(!0),r(S,null,F(l.value,(a,y)=>(o(),r("div",{key:y,class:m(["px-4 py-0.5 hover:bg-zinc-800 border-l-2 flex",{"border-transparent":a.type==="stdout","border-red-500 bg-red-500/5":a.type==="stderr","border-amber-500 bg-amber-500/5":a.type==="warning"}])},[e("span",X,i(y+1),1),e("span",{class:m(["flex-1 whitespace-pre-wrap break-all",{"text-zinc-300":a.type==="stdout","text-red-400":a.type==="stderr","text-amber-400":a.type==="warning"}])},i(k(a)),3)],2))),128))])):(o(),r("div",Y," No logs available for this deployment "))])])]))}};export{ee as default};
