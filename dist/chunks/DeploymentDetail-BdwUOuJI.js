import{r as p,m as j,p as B,b as r,o,d as t,e as m,i as C,j as N,u as _,R as S,t as i,q as F,n as x,f as w,F as I,g as V,l as q}from"../app.js";const M={class:"p-6 space-y-6"},R={class:"flex items-center gap-4"},A={class:"mt-1 text-sm text-zinc-400"},P={class:"text-zinc-500"},U={key:0,class:"flex items-center gap-6 text-sm"},E={class:"text-zinc-400"},O={key:0,class:"text-zinc-400"},T={class:"text-zinc-300 bg-zinc-800 px-1.5 py-0.5 rounded"},G={class:"rounded-xl border border-zinc-800 bg-zinc-900 overflow-hidden"},H={class:"border-b border-zinc-800 px-4 py-3 flex items-center justify-between"},J={class:"flex items-center gap-3"},K={key:0,class:"text-xs text-zinc-500"},Q={key:0,class:"flex items-center gap-2 text-sm text-amber-400"},W={class:"max-h-[600px] overflow-auto"},X={key:0,class:"flex items-center justify-center py-12"},Y={key:1,class:"font-mono text-xs"},Z={class:"text-zinc-600 select-none w-12 flex-shrink-0 text-right pr-4"},$={key:2,class:"px-4 py-12 text-center text-zinc-500"},se={__name:"DeploymentDetail",setup(ee){const f=F(),g=q("api"),n=p(null),l=p([]),z=p(!0),v=p(!0);let c=null;async function y(){try{n.value=await g.getDeployment(f.params.uuid)}catch(e){console.error("Failed to fetch deployment:",e)}finally{z.value=!1}}async function b(){try{const e=await g.getDeploymentLogs(f.params.uuid);l.value=Array.isArray(e.logs)?e.logs:[]}catch(e){console.error("Failed to fetch logs:",e)}finally{v.value=!1}}function k(e){return e?new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-"}function D(e){return e==="finished"?"bg-emerald-500/10 text-emerald-400":e==="failed"?"bg-red-500/10 text-red-400":e==="in_progress"?"bg-amber-500/10 text-amber-400":"bg-zinc-500/10 text-zinc-400"}function L(e){return e?(e.output||e.toString()).replace(/\x1b\[[0-9;]*m/g,""):""}return j(async()=>{var e,s;await Promise.all([y(),b()]),(((e=n.value)==null?void 0:e.status)==="in_progress"||((s=n.value)==null?void 0:s.status)==="queued")&&(c=setInterval(async()=>{var u,d;await Promise.all([y(),b()]),((u=n.value)==null?void 0:u.status)!=="in_progress"&&((d=n.value)==null?void 0:d.status)!=="queued"&&clearInterval(c)},3e3))}),B(()=>{c&&clearInterval(c)}),(e,s)=>{var u,d;return o(),r("div",M,[t("div",R,[C(_(S),{to:"/deployments",class:"flex h-8 w-8 items-center justify-center rounded-lg border border-zinc-800 hover:bg-zinc-800 transition-colors"},{default:N(()=>[...s[0]||(s[0]=[t("svg",{class:"h-4 w-4 text-zinc-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"})],-1)])]),_:1}),t("div",null,[s[1]||(s[1]=t("h1",{class:"text-2xl font-semibold text-white"},"Deployment Logs",-1)),t("p",A,[t("code",P,i(_(f).params.uuid),1)])])]),n.value?(o(),r("div",U,[t("span",{class:x([D(n.value.status),"inline-flex items-center rounded-full px-3 py-1 text-sm font-medium capitalize"])},i(n.value.status),3),t("span",E," Started "+i(k(n.value.created_at)),1),n.value.commit?(o(),r("span",O,[s[2]||(s[2]=w(" Commit: ",-1)),t("code",T,i((u=n.value.commit)==null?void 0:u.substring(0,7)),1)])):m("",!0)])):m("",!0),t("div",G,[t("div",H,[t("div",J,[s[3]||(s[3]=t("span",{class:"text-sm font-medium text-white"},"Build Output",-1)),l.value.length?(o(),r("span",K,i(l.value.length)+" lines",1)):m("",!0)]),((d=n.value)==null?void 0:d.status)==="in_progress"?(o(),r("div",Q,[...s[4]||(s[4]=[t("div",{class:"h-2 w-2 rounded-full bg-amber-400 animate-pulse"},null,-1),w(" Building... ",-1)])])):m("",!0)]),t("div",W,[v.value?(o(),r("div",X,[...s[5]||(s[5]=[t("div",{class:"h-6 w-6 animate-spin rounded-full border-2 border-zinc-700 border-t-violet-500"},null,-1)])])):l.value.length?(o(),r("div",Y,[(o(!0),r(I,null,V(l.value,(a,h)=>(o(),r("div",{key:h,class:x(["px-4 py-0.5 hover:bg-zinc-800 border-l-2 flex",{"border-transparent":a.type==="stdout","border-red-500 bg-red-500/5":a.type==="stderr","border-amber-500 bg-amber-500/5":a.type==="warning"}])},[t("span",Z,i(h+1),1),t("span",{class:x(["flex-1 whitespace-pre-wrap break-all",{"text-zinc-300":a.type==="stdout","text-red-400":a.type==="stderr","text-amber-400":a.type==="warning"}])},i(L(a)),3)],2))),128))])):(o(),r("div",$," No logs available for this deployment "))])])])}}};export{se as default};
